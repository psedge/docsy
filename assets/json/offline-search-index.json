{{- $.Scratch.Add "offline-search-index" slice -}}
{{- range where .Site.AllPages ".Params.exclude_search" "!=" true -}}
{{- $.Scratch.Add "offline-search-index" (dict "ref" .RelPermalink "title" .Title "categories" (.Params.categories | default "") "tags" (.Params.tags | default "") "description" .Params.description  "body" .Plain "excerpt" (.Summary | truncate 200) "last_mod" .Lastmod) -}}
{{- end -}}
{{- $.Scratch.Get "offline-search-index" | jsonify -}}
